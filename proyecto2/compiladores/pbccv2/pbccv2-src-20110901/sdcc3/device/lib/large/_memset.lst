                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.0.1 #6227 (Oct  2 2015) (Linux)
                              4 ; This file was generated Fri Oct  2 17:15:29 2015
                              5 ;--------------------------------------------------------
                              6 	.module _memset
                              7 	.optsdcc -mmcs51 --model-large
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 ;--------------------------------------------------------
                             13 ; special function registers
                             14 ;--------------------------------------------------------
                             15 	.area RSEG    (ABS,DATA)
   0000                      16 	.org 0x0000
                             17 ;--------------------------------------------------------
                             18 ; special function bits
                             19 ;--------------------------------------------------------
                             20 	.area RSEG    (ABS,DATA)
   0000                      21 	.org 0x0000
                             22 ;--------------------------------------------------------
                             23 ; overlayable register banks
                             24 ;--------------------------------------------------------
                             25 	.area REG_BANK_0	(REL,OVR,DATA)
   0000                      26 	.ds 8
                             27 ;--------------------------------------------------------
                             28 ; internal ram data
                             29 ;--------------------------------------------------------
                             30 	.area DSEG    (DATA)
                             31 ;--------------------------------------------------------
                             32 ; overlayable items in internal ram 
                             33 ;--------------------------------------------------------
                             34 	.area OSEG    (OVR,DATA)
                             35 ;--------------------------------------------------------
                             36 ; indirectly addressable internal ram data
                             37 ;--------------------------------------------------------
                             38 	.area ISEG    (DATA)
                             39 ;--------------------------------------------------------
                             40 ; absolute internal ram data
                             41 ;--------------------------------------------------------
                             42 	.area IABS    (ABS,DATA)
                             43 	.area IABS    (ABS,DATA)
                             44 ;--------------------------------------------------------
                             45 ; bit data
                             46 ;--------------------------------------------------------
                             47 	.area BSEG    (BIT)
                             48 ;--------------------------------------------------------
                             49 ; paged external ram data
                             50 ;--------------------------------------------------------
                             51 	.area PSEG    (PAG,XDATA)
                             52 ;--------------------------------------------------------
                             53 ; external ram data
                             54 ;--------------------------------------------------------
                             55 	.area XSEG    (XDATA)
                             56 ;--------------------------------------------------------
                             57 ; absolute external ram data
                             58 ;--------------------------------------------------------
                             59 	.area XABS    (ABS,XDATA)
                             60 ;--------------------------------------------------------
                             61 ; external initialized ram data
                             62 ;--------------------------------------------------------
                             63 	.area XISEG   (XDATA)
                             64 	.area HOME    (CODE)
                             65 	.area GSINIT0 (CODE)
                             66 	.area GSINIT1 (CODE)
                             67 	.area GSINIT2 (CODE)
                             68 	.area GSINIT3 (CODE)
                             69 	.area GSINIT4 (CODE)
                             70 	.area GSINIT5 (CODE)
                             71 	.area GSINIT  (CODE)
                             72 	.area GSFINAL (CODE)
                             73 	.area CSEG    (CODE)
                             74 ;--------------------------------------------------------
                             75 ; global & static initialisations
                             76 ;--------------------------------------------------------
                             77 	.area HOME    (CODE)
                             78 	.area GSINIT  (CODE)
                             79 	.area GSFINAL (CODE)
                             80 	.area GSINIT  (CODE)
                             81 ;--------------------------------------------------------
                             82 ; Home
                             83 ;--------------------------------------------------------
                             84 	.area HOME    (CODE)
                             85 	.area HOME    (CODE)
                             86 ;--------------------------------------------------------
                             87 ; code
                             88 ;--------------------------------------------------------
                             89 	.area CSEG    (CODE)
                             90 ;------------------------------------------------------------
                             91 ;Allocation info for local variables in function 'dummy'
                             92 ;------------------------------------------------------------
                             93 ;------------------------------------------------------------
                             94 ;	_memset.c:54: static void dummy(void) __naked
                             95 ;	-----------------------------------------
                             96 ;	 function dummy
                             97 ;	-----------------------------------------
   0000                      98 _dummy:
                             99 ;	naked function: no prologue.
                            100 ;	_memset.c:126: mov     r6,a
                            101 	
                            102 ;	# 108 "_memset.c"
                            103 	        .area XSEG (XDATA)
                            104 	
   0000                     105 	        _memset_PARM_2::
   0000                     106 	                .ds 1
   0001                     107 	        _memset_PARM_3::
   0001                     108 	                .ds 2
                            109 	
                            110 	        .area CSEG (CODE)
                            111 	
   0000                     112 	        _memset::
                            113 	
                            114         ; Assign buf (b holds memspace, no need to touch)
   0000 AC 82               115 	                mov r4,dpl
   0002 AD 83               116 	                mov r5,dph
                            117                 ;
                            118         ; Assign count
   0004 90s00r01            119 	                mov dptr,#_memset_PARM_3
   0007 E0                  120 	                movx a,@dptr
   0008 FE                  121 	                mov r6,a
   0009 A3                  122 	                inc dptr
   000A E0                  123 	                movx a,@dptr
   000B FF                  124 	                mov r7,a
                            125                 ;
                            126         ; if (!count) return buf;
                            127         ; check for count != 0 intermangled with gymnastic
                            128         ; preparing djnz instructions
   000C BE 00 03            129 	                cjne r6,#0x00,COUNT_LSB_NOT_ZERO
                            130         ; acc holds r7
   000F 60 12               131 	                jz MEMSET_END
   0011 1F                  132 	                dec r7
   0012                     133 	        COUNT_LSB_NOT_ZERO:
   0012 0F                  134 	                inc r7
                            135                 ;
                            136         ; Assign ch
   0013 90s00r00            137 	                mov dptr,#_memset_PARM_2
   0016 E0                  138 	                movx a,@dptr
                            139         ; acc is precious now
                            140                 ;
                            141         ; Restore dptr
   0017 8C 82               142 	                mov dpl,r4
   0019 8D 83               143 	                mov dph,r5
                            144 	
                            145 	
                            146 	
                            147 	
                            148 	
                            149         ; _memset.c do {
                            150 	
   001B                     151 	        MEMSET_LOOP:
                            152         ; _memset.c *p = ch;
   001B 12s00r00            153 	                lcall __gptrput
                            154 	
                            155         ; _memset.c p++;
   001E A3                  156 	                inc dptr
                            157 	
                            158         ; _memset.c } while(--count) ;
   001F DE FA               159 	                djnz r6,MEMSET_LOOP
   0021 DF F8               160 	                djnz r7,MEMSET_LOOP
                            161                 ;
                            162 	
   0023                     163 	        MEMSET_END:
                            164         ; _memset.c return buf ;
                            165                 ; b was unchanged
   0023 8C 82               166 	                mov dpl,r4
   0025 8D 83               167 	                mov dph,r5
                            168                 ;
   0027 22                  169 	                ret
                            170 	
                            171 	    
                            172 ;	naked function: no epilogue.
                            173 	.area CSEG    (CODE)
                            174 	.area CONST   (CODE)
                            175 	.area XINIT   (CODE)
                            176 	.area CABS    (ABS,CODE)
