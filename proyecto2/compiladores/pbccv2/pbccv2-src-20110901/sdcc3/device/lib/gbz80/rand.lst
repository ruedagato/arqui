                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.0.1 #6227 (Oct  2 2015) (Linux)
                              4 ; This file was generated Fri Oct  2 17:18:19 2015
                              5 ;--------------------------------------------------------
                              6 	.module rand
                              7 	.optsdcc -mgbz80
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 	.globl _rand
                             13 	.globl _srand
                             14 ;--------------------------------------------------------
                             15 ;  ram data
                             16 ;--------------------------------------------------------
                             17 	.area _DATA
   0000                      18 _next:
   0000                      19 	.ds 4
                             20 ;--------------------------------------------------------
                             21 ; overlayable items in  ram 
                             22 ;--------------------------------------------------------
                             23 	.area _OVERLAY
                             24 ;--------------------------------------------------------
                             25 ; external initialized ram data
                             26 ;--------------------------------------------------------
                             27 ;--------------------------------------------------------
                             28 ; global & static initialisations
                             29 ;--------------------------------------------------------
                             30 	.area _HOME
                             31 	.area _GSINIT
                             32 	.area _GSFINAL
                             33 	.area _GSINIT
                             34 ;../rand.c:31: static unsigned long int next = 1;
   0000 21r00s00             35 	ld	hl,#_next
   0003 36 01                36 	ld	(hl),#0x01
   0005 AF                   37 	xor	a,a
   0006 23                   38 	inc	hl
   0007 77                   39 	ld	(hl),a
   0008 23                   40 	inc	hl
   0009 77                   41 	ld	(hl),a
   000A 23                   42 	inc	hl
   000B 77                   43 	ld	(hl),a
                             44 ;--------------------------------------------------------
                             45 ; Home
                             46 ;--------------------------------------------------------
                             47 	.area _HOME
                             48 	.area _HOME
                             49 ;--------------------------------------------------------
                             50 ; code
                             51 ;--------------------------------------------------------
                             52 	.area _CODE
                             53 ;../rand.c:33: int rand(void)
                             54 ;	---------------------------------
                             55 ; Function rand
                             56 ; ---------------------------------
   0000                      57 _rand_start::
   0000                      58 _rand:
                             59 	
   0000 F5                   60 	push	af
   0001 F5                   61 	push	af
                             62 ;../rand.c:35: next = next * 1103515245UL + 12345;
   0002 21r02s00             63 	ld	hl,#_next + 2
   0005 7E                   64 	ld	a,(hl)
   0006 23                   65 	inc	hl
   0007 66                   66 	ld	h,(hl)
   0008 6F                   67 	ld	l,a
   0009 E5                   68 	push	hl
   000A 21r00s00             69 	ld	hl,#_next
   000D 7E                   70 	ld	a,(hl)
   000E 23                   71 	inc	hl
   000F 66                   72 	ld	h,(hl)
   0010 6F                   73 	ld	l,a
   0011 E5                   74 	push	hl
   0012 21 C6 41             75 	ld	hl,#0x41C6
   0015 E5                   76 	push	hl
   0016 21 6D 4E             77 	ld	hl,#0x41C64E6D
   0019 E5                   78 	push	hl
   001A CDr00s00             79 	call	__mullong_rrx_s
   001D E8 08                80 	lda	sp,8(sp)
   001F E5                   81 	push	hl
   0020 F8 02                82 	ldhl	sp,#2
   0022 73                   83 	ld	(hl),e
   0023 23                   84 	inc	hl
   0024 72                   85 	ld	(hl),d
   0025 D1                   86 	pop	de
   0026 23                   87 	inc	hl
   0027 73                   88 	ld	(hl),e
   0028 23                   89 	inc	hl
   0029 72                   90 	ld	(hl),d
   002A F8 01                91 	ldhl	sp,#1
   002C 2B                   92 	dec	hl
   002D 5E                   93 	ld	e,(hl)
   002E 23                   94 	inc	hl
   002F 56                   95 	ld	d,(hl)
   0030 7B                   96 	ld	a,e
   0031 C6 39                97 	add	a,#0x39
   0033 5F                   98 	ld	e,a
   0034 7A                   99 	ld	a,d
   0035 CE 30               100 	adc	a,#0x30
   0037 F5                  101 	push	af
   0038 21r01s00            102 	ld	hl,#_next + 1
   003B 77                  103 	ld	(hl),a
   003C 2B                  104 	dec	hl
   003D 73                  105 	ld	(hl),e
   003E F8 05               106 	ldhl	sp,#5
   0040 2B                  107 	dec	hl
   0041 5E                  108 	ld	e,(hl)
   0042 23                  109 	inc	hl
   0043 56                  110 	ld	d,(hl)
   0044 F1                  111 	pop	af
   0045 7B                  112 	ld	a,e
   0046 CE 00               113 	adc	a,#0x00
   0048 5F                  114 	ld	e,a
   0049 7A                  115 	ld	a,d
   004A CE 00               116 	adc	a,#0x00
   004C 21r03s00            117 	ld	hl,#_next + 3
   004F 77                  118 	ld	(hl),a
   0050 2B                  119 	dec	hl
   0051 73                  120 	ld	(hl),e
                            121 ;../rand.c:36: return (unsigned int)(next/65536) % (RAND_MAX + 1U);
   0052 3E 10               122 	ld	a,#0x10
   0054 F5                  123 	push	af
   0055 33                  124 	inc	sp
   0056 7E                  125 	ld	a,(hl)
   0057 23                  126 	inc	hl
   0058 66                  127 	ld	h,(hl)
   0059 6F                  128 	ld	l,a
   005A E5                  129 	push	hl
   005B 21r00s00            130 	ld	hl,#_next
   005E 7E                  131 	ld	a,(hl)
   005F 23                  132 	inc	hl
   0060 66                  133 	ld	h,(hl)
   0061 6F                  134 	ld	l,a
   0062 E5                  135 	push	hl
   0063 CDr00s00            136 	call	__rrulong_rrx_s
   0066 E8 05               137 	lda	sp,5(sp)
   0068 E5                  138 	push	hl
   0069 F8 02               139 	ldhl	sp,#2
   006B 73                  140 	ld	(hl),e
   006C 23                  141 	inc	hl
   006D 72                  142 	ld	(hl),d
   006E D1                  143 	pop	de
   006F 23                  144 	inc	hl
   0070 73                  145 	ld	(hl),e
   0071 23                  146 	inc	hl
   0072 72                  147 	ld	(hl),d
   0073 F8 00               148 	ldhl	sp,#0
   0075 4E                  149 	ld	c,(hl)
   0076 23                  150 	inc	hl
   0077 7E                  151 	ld	a,(hl)
   0078 E6 7F               152 	and	a,#0x7F
   007A 47                  153 	ld	b,a
   007B 59                  154 	ld	e,c
   007C 50                  155 	ld	d,b
   007D                     156 00101$:
   007D E8 04               157 	lda	sp,4(sp)
   007F C9                  158 	ret
   0080                     159 _rand_end::
                            160 ;../rand.c:39: void srand(unsigned int seed)
                            161 ;	---------------------------------
                            162 ; Function srand
                            163 ; ---------------------------------
   0080                     164 _srand_start::
   0080                     165 _srand:
                            166 	
                            167 ;../rand.c:41: next = seed;
   0080 F8 02               168 	ldhl	sp,#2
   0082 7E                  169 	ld	a,(hl)
   0083 21r00s00            170 	ld	hl,#_next
   0086 77                  171 	ld	(hl),a
   0087 F8 03               172 	ldhl	sp,#3
   0089 7E                  173 	ld	a,(hl)
   008A 21r01s00            174 	ld	hl,#_next + 1
   008D 77                  175 	ld	(hl),a
   008E 23                  176 	inc	hl
   008F 36 00               177 	ld	(hl),#0x00
   0091 23                  178 	inc	hl
   0092 36 00               179 	ld	(hl),#0x00
   0094                     180 00101$:
                            181 	
   0094 C9                  182 	ret
   0095                     183 _srand_end::
                            184 	.area _CODE
                            185 	.area _CABS
