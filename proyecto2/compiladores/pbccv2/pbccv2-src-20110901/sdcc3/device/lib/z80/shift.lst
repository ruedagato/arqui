                              1 ;--------------------------------------------------------------------------
                              2 ;  putchar.s
                              3 ;
                              4 ;  Copyright (C) 2001, Michael Hope
                              5 ;
                              6 ;  This library is free software; you can redistribute it and/or modify it
                              7 ;  under the terms of the GNU General Public License as published by the
                              8 ;  Free Software Foundation; either version 2.1, or (at your option) any
                              9 ;  later version.
                             10 ;
                             11 ;  This library is distributed in the hope that it will be useful,
                             12 ;  but WITHOUT ANY WARRANTY; without even the implied warranty of
                             13 ;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
                             14 ;  GNU General Public License for more details.
                             15 ;
                             16 ;  You should have received a copy of the GNU General Public License 
                             17 ;  along with this library; see the file COPYING. If not, write to the
                             18 ;  Free Software Foundation, 51 Franklin Street, Fifth Floor, Boston,
                             19 ;   MA 02110-1301, USA.
                             20 ;
                             21 ;  As a special exception, if you link this library with other files,
                             22 ;  some of which are compiled with SDCC, to produce an executable,
                             23 ;  this library does not by itself cause the resulting executable to
                             24 ;  be covered by the GNU General Public License. This exception does
                             25 ;  not however invalidate any other reasons why the executable file
                             26 ;   might be covered by the GNU General Public License.
                             27 ;--------------------------------------------------------------------------
                             28 
                             29         ;;
   0000                      30 __rrulong_rrx_s::
   0000 21 06 00             31         ld      hl,#2+4
   0003 39                   32         add     hl,sp
                             33 
   0004 7E                   34         ld      a,(hl)
   0005 B7                   35         or      a,a
   0006 C1                   36 	pop     bc
   0007 E1                   37 	pop     hl
   0008 D1                   38 	pop     de
   0009 D5                   39 	push    de
   000A E5                   40 	push    hl
   000B C5                   41 	push    bc
   000C C8                   42         ret     Z
   000D 47                   43         ld      b,a
   000E 7B                   44         ld      a,e
   000F                      45 1$:
   000F CB 3A                46         srl     d
   0011 1F                   47         rra
   0012 CB 1C                48         rr	h
   0014 CB 1D                49         rr      l
                             50 
   0016 10 F7                51         djnz    1$
   0018 5F                   52         ld      e,a
   0019 C9                   53         ret
                             54 
   001A                      55 __rrslong_rrx_s::
   001A 21 06 00             56         ld      hl,#2+4
   001D 39                   57         add     hl,sp
                             58 
   001E 7E                   59         ld      a,(hl)
   001F B7                   60         or      a,a
   0020 C1                   61 	pop     bc
   0021 E1                   62 	pop     hl
   0022 D1                   63 	pop     de
   0023 D5                   64 	push    de
   0024 E5                   65 	push    hl
   0025 C5                   66 	push    bc
   0026 C8                   67         ret     Z
   0027 47                   68         ld      b,a
   0028 7B                   69         ld      a,e
   0029                      70 2$:
   0029 CB 2A                71         sra     d
   002B 1F                   72         rra
   002C CB 1C                73         rr	h
   002E CB 1D                74         rr      l
                             75 
   0030 10 F7                76         djnz    2$
   0032 5F                   77         ld      e,a
   0033 C9                   78         ret
                             79 
   0034                      80 __rlslong_rrx_s::
   0034                      81 __rlulong_rrx_s::
   0034 21 06 00             82         ld      hl,#2+4
   0037 39                   83         add     hl,sp
                             84 
   0038 7E                   85         ld      a,(hl)
   0039 B7                   86         or      a,a
   003A C1                   87 	pop     bc
   003B E1                   88 	pop     hl
   003C D1                   89 	pop     de
   003D D5                   90 	push    de
   003E E5                   91 	push    hl
   003F C5                   92 	push    bc
   0040 C8                   93         ret     Z
   0041 47                   94         ld      b,a
   0042 7B                   95         ld      a,e
   0043                      96 3$:
   0043 29                   97         add     hl,hl
   0044 17                   98         rla
   0045 CB 12                99         rl	d
                            100 
   0047 10 FA               101         djnz    3$
   0049 5F                  102         ld      e,a
   004A C9                  103         ret
