                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.0.1 #6227 (Oct  2 2015) (Linux)
                              4 ; This file was generated Fri Oct  2 17:15:21 2015
                              5 ;--------------------------------------------------------
                              6 	.module _realloc
                              7 	.optsdcc -mhc08
                              8 	
                              9 	.area HOME (CODE)
                             10 	.area GSINIT0 (CODE)
                             11 	.area GSINIT (CODE)
                             12 	.area GSFINAL (CODE)
                             13 	.area CSEG (CODE)
                             14 	.area XINIT
                             15 	.area CONST   (CODE)
                             16 	.area DSEG
                             17 	.area OSEG    (OVR)
                             18 	.area BSEG
                             19 	.area XSEG
                             20 	.area XISEG
                             21 ;--------------------------------------------------------
                             22 ; Public variables in this module
                             23 ;--------------------------------------------------------
                             24 	.globl _realloc_PARM_2
                             25 	.globl _realloc
                             26 ;--------------------------------------------------------
                             27 ;  ram data
                             28 ;--------------------------------------------------------
                             29 	.area DSEG
   0000                      30 _realloc_sloc0_1_0:
   0000                      31 	.ds 2
   0002                      32 _realloc_sloc1_1_0:
   0002                      33 	.ds 2
   0004                      34 _realloc_sloc2_1_0:
   0004                      35 	.ds 2
                             36 ;--------------------------------------------------------
                             37 ; overlayable items in  ram 
                             38 ;--------------------------------------------------------
                             39 	.area OSEG    (OVR)
                             40 ;--------------------------------------------------------
                             41 ; absolute external ram data
                             42 ;--------------------------------------------------------
                             43 	.area XABS    (ABS)
                             44 ;--------------------------------------------------------
                             45 ; external initialized ram data
                             46 ;--------------------------------------------------------
                             47 	.area XISEG
                             48 ;--------------------------------------------------------
                             49 ; extended address mode data
                             50 ;--------------------------------------------------------
                             51 	.area XSEG
   0000                      52 _realloc_PARM_2:
   0000                      53 	.ds 2
   0002                      54 _realloc_p_1_1:
   0002                      55 	.ds 2
   0004                      56 _realloc_pthis_1_1:
   0004                      57 	.ds 2
   0006                      58 _realloc_pnew_1_1:
   0006                      59 	.ds 2
   0008                      60 _realloc_ret_1_1:
   0008                      61 	.ds 2
                             62 ;--------------------------------------------------------
                             63 ; global & static initialisations
                             64 ;--------------------------------------------------------
                             65 	.area HOME (CODE)
                             66 	.area GSINIT (CODE)
                             67 	.area GSFINAL (CODE)
                             68 	.area GSINIT (CODE)
                             69 ;--------------------------------------------------------
                             70 ; Home
                             71 ;--------------------------------------------------------
                             72 	.area HOME (CODE)
                             73 	.area HOME (CODE)
                             74 ;--------------------------------------------------------
                             75 ; code
                             76 ;--------------------------------------------------------
                             77 	.area CSEG (CODE)
                             78 ;------------------------------------------------------------
                             79 ;Allocation info for local variables in function 'realloc'
                             80 ;------------------------------------------------------------
                             81 ;sloc0                     Allocated with name '_realloc_sloc0_1_0'
                             82 ;sloc1                     Allocated with name '_realloc_sloc1_1_0'
                             83 ;sloc2                     Allocated with name '_realloc_sloc2_1_0'
                             84 ;size                      Allocated with name '_realloc_PARM_2'
                             85 ;p                         Allocated with name '_realloc_p_1_1'
                             86 ;pthis                     Allocated with name '_realloc_pthis_1_1'
                             87 ;pnew                      Allocated with name '_realloc_pnew_1_1'
                             88 ;ret                       Allocated with name '_realloc_ret_1_1'
                             89 ;------------------------------------------------------------
                             90 ;../_realloc.c:84: void __xdata * realloc (void * p, size_t size)
                             91 ;	-----------------------------------------
                             92 ;	 function realloc
                             93 ;	-----------------------------------------
   0000                      94 _realloc:
   0000 C7s00r03             95 	sta	(_realloc_p_1_1 + 1)
   0003 CFs00r02             96 	stx	_realloc_p_1_1
                             97 ;../_realloc.c:92: pthis = _sdcc_find_memheader(p);
   0006 CEs00r02             98 	ldx	_realloc_p_1_1
   0009 C6s00r03             99 	lda	(_realloc_p_1_1 + 1)
   000C CDs00r00            100 	jsr	__sdcc_find_memheader
   000F C7s00r05            101 	sta	(_realloc_pthis_1_1 + 1)
   0012 CFs00r04            102 	stx	_realloc_pthis_1_1
                            103 ;../_realloc.c:93: if (pthis)
   0015 C6s00r05            104 	lda	(_realloc_pthis_1_1 + 1)
   0018 CAs00r04            105 	ora	_realloc_pthis_1_1
   001B 26 03               106 	bne	00124$
   001D CCs02r07            107 	jmp	00114$
   0020                     108 00124$:
                            109 ;../_realloc.c:95: if (size > (0xFFFF-HEADER_SIZE))
   0020 A6 FB               110 	lda	#0xFB
   0022 C0s00r01            111 	sub	(_realloc_PARM_2 + 1)
   0025 A6 FF               112 	lda	#0xFF
   0027 C2s00r00            113 	sbc	_realloc_PARM_2
   002A 24 0A               114 	bcc	00111$
   002C                     115 00125$:
                            116 ;../_realloc.c:97: ret = (void __xdata *) NULL; //To prevent overflow in next line
   002C 4F                  117 	clra
   002D C7s00r08            118 	sta	_realloc_ret_1_1
   0030 C7s00r09            119 	sta	(_realloc_ret_1_1 + 1)
   0033 CCs02r16            120 	jmp	00115$
   0036                     121 00111$:
                            122 ;../_realloc.c:101: size += HEADER_SIZE; //We need a memory for header too
   0036 C6s00r01            123 	lda	(_realloc_PARM_2 + 1)
   0039 AB 04               124 	add	#0x04
   003B C7s00r01            125 	sta	(_realloc_PARM_2 + 1)
   003E 24 07               126 	bcc	00126$
   0040 C6s00r00            127 	lda	_realloc_PARM_2
   0043 4C                  128 	inca
   0044 C7s00r00            129 	sta	_realloc_PARM_2
   0047                     130 00126$:
                            131 ;../_realloc.c:103: if ((((unsigned int)pthis->next) - ((unsigned int)pthis)) >= size)
   0047 C6s00r04            132 	lda	_realloc_pthis_1_1
   004A CEs00r05            133 	ldx	(_realloc_pthis_1_1 + 1)
   004D 87                  134 	psha
   004E 8A                  135 	pulh
   004F F6                  136 	lda	,x
   0050 AF 01               137 	aix	#1
   0052 B7*00               138 	sta	*_realloc_sloc0_1_0
   0054 F6                  139 	lda	,x
   0055 B7*01               140 	sta	*(_realloc_sloc0_1_0 + 1)
   0057 C6s00r05            141 	lda	(_realloc_pthis_1_1 + 1)
   005A B7*03               142 	sta	*(_realloc_sloc1_1_0 + 1)
   005C C6s00r04            143 	lda	_realloc_pthis_1_1
   005F B7*02               144 	sta	*_realloc_sloc1_1_0
   0061 B6*01               145 	lda	*(_realloc_sloc0_1_0 + 1)
   0063 B0*03               146 	sub	*(_realloc_sloc1_1_0 + 1)
   0065 B7*03               147 	sta	*(_realloc_sloc1_1_0 + 1)
   0067 B6*00               148 	lda	*_realloc_sloc0_1_0
   0069 B2*02               149 	sbc	*_realloc_sloc1_1_0
   006B B7*02               150 	sta	*_realloc_sloc1_1_0
   006D B6*03               151 	lda	*(_realloc_sloc1_1_0 + 1)
   006F C0s00r01            152 	sub	(_realloc_PARM_2 + 1)
   0072 B6*02               153 	lda	*_realloc_sloc1_1_0
   0074 C2s00r00            154 	sbc	_realloc_PARM_2
   0077 25 29               155 	bcs	00108$
   0079                     156 00127$:
                            157 ;../_realloc.c:105: pthis->len = size;
   0079 C6s00r05            158 	lda	(_realloc_pthis_1_1 + 1)
   007C AB 02               159 	add	#0x02
   007E B7*03               160 	sta	*(_realloc_sloc1_1_0 + 1)
   0080 C6s00r04            161 	lda	_realloc_pthis_1_1
   0083 A9 00               162 	adc	#0x00
   0085 B7*02               163 	sta	*_realloc_sloc1_1_0
   0087 55*02               164 	ldhx	*_realloc_sloc1_1_0
   0089 C6s00r00            165 	lda	_realloc_PARM_2
   008C F7                  166 	sta	,x
   008D AF 01               167 	aix	#1
   008F C6s00r01            168 	lda	(_realloc_PARM_2 + 1)
   0092 F7                  169 	sta	,x
                            170 ;../_realloc.c:106: ret = p;
   0093 C6s00r02            171 	lda	_realloc_p_1_1
   0096 C7s00r08            172 	sta	_realloc_ret_1_1
   0099 C6s00r03            173 	lda	(_realloc_p_1_1 + 1)
   009C C7s00r09            174 	sta	(_realloc_ret_1_1 + 1)
   009F CCs02r16            175 	jmp	00115$
   00A2                     176 00108$:
                            177 ;../_realloc.c:110: if ((_sdcc_prev_memheader) &&
   00A2 C6s00r01            178 	lda	(__sdcc_prev_memheader + 1)
   00A5 CAs00r00            179 	ora	__sdcc_prev_memheader
   00A8 26 03               180 	bne	00128$
   00AA CCs01r9A            181 	jmp	00104$
   00AD                     182 00128$:
                            183 ;../_realloc.c:111: ((((unsigned int)pthis->next) -
   00AD C6s00r04            184 	lda	_realloc_pthis_1_1
   00B0 CEs00r05            185 	ldx	(_realloc_pthis_1_1 + 1)
   00B3 87                  186 	psha
   00B4 8A                  187 	pulh
   00B5 F6                  188 	lda	,x
   00B6 AF 01               189 	aix	#1
   00B8 B7*02               190 	sta	*_realloc_sloc1_1_0
   00BA F6                  191 	lda	,x
   00BB B7*03               192 	sta	*(_realloc_sloc1_1_0 + 1)
                            193 ;../_realloc.c:112: ((unsigned int)_sdcc_prev_memheader) -
   00BD C6s00r01            194 	lda	(__sdcc_prev_memheader + 1)
   00C0 B7*01               195 	sta	*(_realloc_sloc0_1_0 + 1)
   00C2 C6s00r00            196 	lda	__sdcc_prev_memheader
   00C5 B7*00               197 	sta	*_realloc_sloc0_1_0
   00C7 B6*03               198 	lda	*(_realloc_sloc1_1_0 + 1)
   00C9 B0*01               199 	sub	*(_realloc_sloc0_1_0 + 1)
   00CB B7*03               200 	sta	*(_realloc_sloc1_1_0 + 1)
   00CD B6*02               201 	lda	*_realloc_sloc1_1_0
   00CF B2*00               202 	sbc	*_realloc_sloc0_1_0
   00D1 B7*02               203 	sta	*_realloc_sloc1_1_0
                            204 ;../_realloc.c:113: _sdcc_prev_memheader->len) >= size))
   00D3 C6s00r00            205 	lda	__sdcc_prev_memheader
   00D6 B7*00               206 	sta	*_realloc_sloc0_1_0
   00D8 C6s00r01            207 	lda	(__sdcc_prev_memheader + 1)
   00DB B7*01               208 	sta	*(_realloc_sloc0_1_0 + 1)
   00DD 55*00               209 	ldhx	*_realloc_sloc0_1_0
   00DF AF 02               210 	aix	#2
   00E1 35*04               211 	sthx	*_realloc_sloc2_1_0
   00E3 55*04               212 	ldhx	*_realloc_sloc2_1_0
   00E5 F6                  213 	lda	,x
   00E6 AF 01               214 	aix	#1
   00E8 B7*04               215 	sta	*_realloc_sloc2_1_0
   00EA F6                  216 	lda	,x
   00EB B7*05               217 	sta	*(_realloc_sloc2_1_0 + 1)
   00ED B6*03               218 	lda	*(_realloc_sloc1_1_0 + 1)
   00EF B0*05               219 	sub	*(_realloc_sloc2_1_0 + 1)
   00F1 B7*05               220 	sta	*(_realloc_sloc2_1_0 + 1)
   00F3 B6*02               221 	lda	*_realloc_sloc1_1_0
   00F5 B2*04               222 	sbc	*_realloc_sloc2_1_0
   00F7 B7*04               223 	sta	*_realloc_sloc2_1_0
   00F9 B6*05               224 	lda	*(_realloc_sloc2_1_0 + 1)
   00FB C0s00r01            225 	sub	(_realloc_PARM_2 + 1)
   00FE B6*04               226 	lda	*_realloc_sloc2_1_0
   0100 C2s00r00            227 	sbc	_realloc_PARM_2
   0103 24 03               228 	bcc	00129$
   0105 CCs01r9A            229 	jmp	00104$
   0108                     230 00129$:
                            231 ;../_realloc.c:115: pnew = (MEMHEADER __xdata * )((char __xdata *)_sdcc_prev_memheader + _sdcc_prev_memheader->len);
   0108 B6*00               232 	lda	*_realloc_sloc0_1_0
   010A C7s00r00            233 	sta	__sdcc_prev_memheader
   010D B6*01               234 	lda	*(_realloc_sloc0_1_0 + 1)
   010F C7s00r01            235 	sta	(__sdcc_prev_memheader + 1)
   0112 55*00               236 	ldhx	*_realloc_sloc0_1_0
   0114 AF 02               237 	aix	#2
   0116 35*04               238 	sthx	*_realloc_sloc2_1_0
   0118 55*04               239 	ldhx	*_realloc_sloc2_1_0
   011A F6                  240 	lda	,x
   011B AF 01               241 	aix	#1
   011D B7*04               242 	sta	*_realloc_sloc2_1_0
   011F F6                  243 	lda	,x
   0120 B7*05               244 	sta	*(_realloc_sloc2_1_0 + 1)
   0122 C6s00r01            245 	lda	(__sdcc_prev_memheader + 1)
   0125 BB*05               246 	add	*(_realloc_sloc2_1_0 + 1)
   0127 C7s00r07            247 	sta	(_realloc_pnew_1_1 + 1)
   012A C6s00r00            248 	lda	__sdcc_prev_memheader
   012D B9*04               249 	adc	*_realloc_sloc2_1_0
   012F C7s00r06            250 	sta	_realloc_pnew_1_1
                            251 ;../_realloc.c:116: _sdcc_prev_memheader->next = pnew;
   0132 55*00               252 	ldhx	*_realloc_sloc0_1_0
   0134 C6s00r06            253 	lda	_realloc_pnew_1_1
   0137 F7                  254 	sta	,x
   0138 AF 01               255 	aix	#1
   013A C6s00r07            256 	lda	(_realloc_pnew_1_1 + 1)
   013D F7                  257 	sta	,x
                            258 ;../_realloc.c:122: memmove(pnew, pthis, pthis->len);
   013E C6s00r05            259 	lda	(_realloc_pthis_1_1 + 1)
   0141 AB 02               260 	add	#0x02
   0143 B7*05               261 	sta	*(_realloc_sloc2_1_0 + 1)
   0145 C6s00r04            262 	lda	_realloc_pthis_1_1
   0148 A9 00               263 	adc	#0x00
   014A B7*04               264 	sta	*_realloc_sloc2_1_0
   014C 55*04               265 	ldhx	*_realloc_sloc2_1_0
   014E F6                  266 	lda	,x
   014F AF 01               267 	aix	#1
   0151 C7s00r00            268 	sta	_memmove_PARM_3
   0154 F6                  269 	lda	,x
   0155 C7s00r01            270 	sta	(_memmove_PARM_3 + 1)
   0158 C6s00r04            271 	lda	_realloc_pthis_1_1
   015B C7s00r00            272 	sta	_memmove_PARM_2
   015E C6s00r05            273 	lda	(_realloc_pthis_1_1 + 1)
   0161 C7s00r01            274 	sta	(_memmove_PARM_2 + 1)
   0164 CEs00r06            275 	ldx	_realloc_pnew_1_1
   0167 C6s00r07            276 	lda	(_realloc_pnew_1_1 + 1)
   016A CDs00r00            277 	jsr	_memmove
                            278 ;../_realloc.c:123: pnew->len = size;
   016D C6s00r07            279 	lda	(_realloc_pnew_1_1 + 1)
   0170 AB 02               280 	add	#0x02
   0172 B7*05               281 	sta	*(_realloc_sloc2_1_0 + 1)
   0174 C6s00r06            282 	lda	_realloc_pnew_1_1
   0177 A9 00               283 	adc	#0x00
   0179 B7*04               284 	sta	*_realloc_sloc2_1_0
   017B 55*04               285 	ldhx	*_realloc_sloc2_1_0
   017D C6s00r00            286 	lda	_realloc_PARM_2
   0180 F7                  287 	sta	,x
   0181 AF 01               288 	aix	#1
   0183 C6s00r01            289 	lda	(_realloc_PARM_2 + 1)
   0186 F7                  290 	sta	,x
                            291 ;../_realloc.c:124: ret = MEM(pnew);
   0187 C6s00r07            292 	lda	(_realloc_pnew_1_1 + 1)
   018A AB 04               293 	add	#0x04
   018C C7s00r09            294 	sta	(_realloc_ret_1_1 + 1)
   018F C6s00r06            295 	lda	_realloc_pnew_1_1
   0192 A9 00               296 	adc	#0x00
   0194 C7s00r08            297 	sta	_realloc_ret_1_1
   0197 CCs02r16            298 	jmp	00115$
   019A                     299 00104$:
                            300 ;../_realloc.c:128: ret = malloc(size - HEADER_SIZE);
   019A C6s00r01            301 	lda	(_realloc_PARM_2 + 1)
   019D A0 04               302 	sub	#0x04
   019F B7*05               303 	sta	*(_realloc_sloc2_1_0 + 1)
   01A1 C6s00r00            304 	lda	_realloc_PARM_2
   01A4 A2 00               305 	sbc	#0x00
   01A6 B7*04               306 	sta	*_realloc_sloc2_1_0
   01A8 BE*04               307 	ldx	*_realloc_sloc2_1_0
   01AA B6*05               308 	lda	*(_realloc_sloc2_1_0 + 1)
   01AC CDs00r00            309 	jsr	_malloc
   01AF C7s00r09            310 	sta	(_realloc_ret_1_1 + 1)
   01B2 CFs00r08            311 	stx	_realloc_ret_1_1
                            312 ;../_realloc.c:129: if (ret)
   01B5 C6s00r09            313 	lda	(_realloc_ret_1_1 + 1)
   01B8 CAs00r08            314 	ora	_realloc_ret_1_1
   01BB 27 59               315 	beq	00115$
   01BD                     316 00130$:
                            317 ;../_realloc.c:131: memcpy(ret, MEM(pthis), pthis->len - HEADER_SIZE);
   01BD C6s00r05            318 	lda	(_realloc_pthis_1_1 + 1)
   01C0 AB 04               319 	add	#0x04
   01C2 C7s00r01            320 	sta	(_memcpy_PARM_2 + 1)
   01C5 C6s00r04            321 	lda	_realloc_pthis_1_1
   01C8 A9 00               322 	adc	#0x00
   01CA C7s00r00            323 	sta	_memcpy_PARM_2
   01CD C6s00r05            324 	lda	(_realloc_pthis_1_1 + 1)
   01D0 AB 02               325 	add	#0x02
   01D2 B7*05               326 	sta	*(_realloc_sloc2_1_0 + 1)
   01D4 C6s00r04            327 	lda	_realloc_pthis_1_1
   01D7 A9 00               328 	adc	#0x00
   01D9 B7*04               329 	sta	*_realloc_sloc2_1_0
   01DB 55*04               330 	ldhx	*_realloc_sloc2_1_0
   01DD F6                  331 	lda	,x
   01DE AF 01               332 	aix	#1
   01E0 B7*04               333 	sta	*_realloc_sloc2_1_0
   01E2 F6                  334 	lda	,x
   01E3 B7*05               335 	sta	*(_realloc_sloc2_1_0 + 1)
   01E5 B6*05               336 	lda	*(_realloc_sloc2_1_0 + 1)
   01E7 A0 04               337 	sub	#0x04
   01E9 C7s00r01            338 	sta	(_memcpy_PARM_3 + 1)
   01EC B6*04               339 	lda	*_realloc_sloc2_1_0
   01EE A2 00               340 	sbc	#0x00
   01F0 C7s00r00            341 	sta	_memcpy_PARM_3
   01F3 CEs00r08            342 	ldx	_realloc_ret_1_1
   01F6 C6s00r09            343 	lda	(_realloc_ret_1_1 + 1)
   01F9 CDs00r00            344 	jsr	_memcpy
                            345 ;../_realloc.c:132: free(p);
   01FC CEs00r02            346 	ldx	_realloc_p_1_1
   01FF C6s00r03            347 	lda	(_realloc_p_1_1 + 1)
   0202 CDs00r00            348 	jsr	_free
   0205 20 0F               349 	bra	00115$
   0207                     350 00114$:
                            351 ;../_realloc.c:140: ret = malloc(size);
   0207 CEs00r00            352 	ldx	_realloc_PARM_2
   020A C6s00r01            353 	lda	(_realloc_PARM_2 + 1)
   020D CDs00r00            354 	jsr	_malloc
   0210 C7s00r09            355 	sta	(_realloc_ret_1_1 + 1)
   0213 CFs00r08            356 	stx	_realloc_ret_1_1
   0216                     357 00115$:
                            358 ;../_realloc.c:143: return ret;
   0216 CEs00r08            359 	ldx	_realloc_ret_1_1
   0219 C6s00r09            360 	lda	(_realloc_ret_1_1 + 1)
   021C                     361 00116$:
   021C 81                  362 	rts
                            363 	.area CSEG (CODE)
                            364 	.area CONST   (CODE)
                            365 	.area XINIT
                            366 	.area CABS    (ABS,CODE)
